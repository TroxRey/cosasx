<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Para Sofia üíú</title>
    <!-- html2canvas para guardar cupones como imagen -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            -webkit-tap-highlight-color: transparent;
        }
        
        html, body {
            width: 100%;
            overflow-x: hidden;
        }
        
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            min-height: 100dvh;
            background: linear-gradient(135deg, #e8d5f2 0%, #f5e6fa 50%, #e0d4f7 100%);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow-x: hidden;
            flex-direction: column;
            text-align: center;
            position: relative;
            padding: 10px;
        }

        /* Emojis flotantes de fondo */
        .hearts-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
            overflow: hidden;
        }

        .floating-heart {
            position: absolute;
            font-size: 20px;
            animation: floatUp 6s ease-in infinite;
            opacity: 0.6;
        }

        @keyframes floatUp {
            0% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
            10% { opacity: 0.6; }
            90% { opacity: 0.6; }
            100% { transform: translateY(-100px) rotate(360deg); opacity: 0; }
        }

        .container {
            position: relative;
            z-index: 10;
            padding: clamp(15px, 4vw, 25px);
            width: 100%;
            max-width: 500px;
            transition: all 0.5s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: clamp(12px, 3vw, 20px);
        }

        h1 {
            color: #7c4dff;
            font-size: clamp(1.1rem, 4.5vw, 2rem);
            padding: 0 10px;
            text-shadow: 2px 2px 4px rgba(124, 77, 255, 0.3);
            line-height: 1.4;
            transition: all 0.3s ease;
        }

        .gif-container {
            transition: all 0.5s ease;
            display: flex;
            justify-content: center;
        }

        .gif-container img {
            width: clamp(100px, 28vw, 150px);
            max-width: 80%;
            height: auto;
            border-radius: 15px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.15);
            transition: all 0.5s ease;
        }

        /* Barra de progreso */
        .progress-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: rgba(124, 77, 255, 0.2);
            z-index: 100;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #7c4dff, #ff69b4);
            width: 0%;
            transition: width 0.5s ease;
        }

        .buttons {
            display: flex;
            gap: clamp(12px, 3vw, 20px);
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
            padding: 10px;
            min-height: 80px;
            width: 100%;
            position: relative;
        }

        button {
            padding: clamp(12px, 3vw, 18px) clamp(24px, 6vw, 36px);
            font-size: clamp(0.9rem, 3.5vw, 1.15rem);
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            font-weight: bold;
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
            touch-action: manipulation;
            -webkit-user-select: none;
            user-select: none;
        }

        #yesBtn {
            background: linear-gradient(145deg, #5cb85c, #4caf50);
            color: white;
            z-index: 100;
            animation: pulse 2s infinite;
            min-width: 130px;
            position: relative;
        }

        @keyframes pulse {
            0%, 100% { box-shadow: 0 8px 25px rgba(76, 175, 80, 0.4); }
            50% { box-shadow: 0 8px 40px rgba(76, 175, 80, 0.8); }
        }

        #yesBtn:hover, #yesBtn:active {
            background: linear-gradient(145deg, #4caf50, #43a047);
            transform: scale(1.08);
        }

        #noBtn {
            background: linear-gradient(145deg, #ff6b6b, #f44336);
            color: white;
            position: fixed;
            transition: left 0.3s ease-out, top 0.3s ease-out, transform 0.2s ease, opacity 0.3s ease;
            z-index: 99;
            min-width: 70px;
            box-shadow: 0 6px 20px rgba(244, 67, 54, 0.5);
        }

        #noBtn:hover {
            background: linear-gradient(145deg, #f44336, #e53935);
        }

        #noBtn:active {
            transform: scale(0.95) !important;
        }

        /* Animaci√≥n de confeti */
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            top: -10px;
            animation: fall linear forwards;
            z-index: 1000;
        }

        @keyframes fall {
            to {
                transform: translateY(105vh) rotate(720deg);
            }
        }

        .floating-gif {
            position: fixed;
            width: clamp(40px, 10vw, 65px);
            height: auto;
            pointer-events: none;
            z-index: 5;
            opacity: 0;
            animation: fadeInFloat 0.8s forwards;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        @keyframes fadeInFloat {
            0% { opacity: 0; transform: translateY(20px) scale(0.5) rotate(-10deg); }
            100% { opacity: 1; transform: translateY(0) scale(1) rotate(0deg); }
        }

        /* Animaci√≥n de shake */
        @keyframes shake {
            0%, 100% { transform: translateX(0) rotate(0); }
            20% { transform: translateX(-8px) rotate(-3deg); }
            40% { transform: translateX(8px) rotate(3deg); }
            60% { transform: translateX(-5px) rotate(-2deg); }
            80% { transform: translateX(5px) rotate(2deg); }
        }

        .shake {
            animation: shake 0.4s ease-in-out;
        }

        /* Mensaje dram√°tico */
        .dramatic-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: clamp(2rem, 10vw, 4rem);
            color: #7c4dff;
            opacity: 0;
            z-index: 200;
            pointer-events: none;
            text-shadow: 2px 2px 10px rgba(124, 77, 255, 0.5);
            animation: dramaticPop 1s ease forwards;
        }

        @keyframes dramaticPop {
            0% { opacity: 0; transform: translate(-50%, -50%) scale(0.5); }
            50% { opacity: 1; transform: translate(-50%, -50%) scale(1.2); }
            100% { opacity: 0; transform: translate(-50%, -50%) scale(1); }
        }

        /* Pantalla de √©xito */
        .success-screen {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            min-height: 100vh;
            padding: clamp(15px, 4vw, 30px);
            animation: fadeIn 0.5s ease;
            overflow-y: auto;
            padding-top: clamp(20px, 5vh, 40px);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }

        /* Efecto de fondo cambiante */
        .sad-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0);
            pointer-events: none;
            z-index: 2;
            transition: background 0.5s ease;
        }

        /* L√°grimas flotantes */
        .tear {
            position: fixed;
            font-size: 30px;
            animation: tearFall 2s linear forwards;
            z-index: 150;
            pointer-events: none;
        }

        @keyframes tearFall {
            0% { transform: translateY(0) scale(1); opacity: 1; }
            100% { transform: translateY(100vh) scale(0.5); opacity: 0; }
        }

        /* Cupones mejorados */
        .coupon {
            border-radius: 20px;
            padding: clamp(20px, 5vw, 30px);
            box-shadow: 0 10px 35px rgba(0, 0, 0, 0.3);
            border: 4px dashed #FFD700;
            position: relative;
            overflow: hidden;
            width: 100%;
            max-width: 320px;
        }

        .coupon-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(255, 215, 0, 0.3);
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.7rem;
            color: #fff;
            font-weight: bold;
        }

        .coupon-emoji {
            font-size: clamp(2.5rem, 10vw, 4rem);
            margin: 0 0 10px 0;
            text-align: center;
        }

        .coupon-title {
            font-size: clamp(1.1rem, 4.5vw, 1.5rem);
            color: #fff;
            margin: 0;
            font-weight: bold;
            text-align: center;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.4);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .coupon-subtitle {
            font-size: clamp(0.95rem, 4vw, 1.2rem);
            margin: 8px 0 0 0;
            text-align: center;
            font-weight: 600;
        }

        .save-btn {
            background: linear-gradient(145deg, #7c4dff, #9b6dff);
            color: white;
            padding: clamp(10px, 2.5vw, 14px) clamp(18px, 4vw, 28px);
            border: none;
            border-radius: 50px;
            font-weight: bold;
            font-size: clamp(0.8rem, 3vw, 0.95rem);
            box-shadow: 0 6px 20px rgba(124, 77, 255, 0.4);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .save-btn:hover, .save-btn:active {
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(124, 77, 255, 0.6);
        }

        .whatsapp-btn {
            display: inline-block;
            background: linear-gradient(145deg, #25D366, #128C7E);
            color: white;
            padding: clamp(14px, 3.5vw, 18px) clamp(30px, 7vw, 45px);
            border-radius: 50px;
            text-decoration: none;
            font-weight: bold;
            font-size: clamp(0.95rem, 3.5vw, 1.15rem);
            box-shadow: 0 8px 25px rgba(37, 211, 102, 0.5);
            transition: all 0.3s ease;
            border: 2px solid #fff;
        }

        .whatsapp-btn:hover, .whatsapp-btn:active {
            transform: scale(1.05);
            box-shadow: 0 10px 30px rgba(37, 211, 102, 0.7);
        }

        /* Responsive para pantallas muy peque√±as */
        @media (max-width: 360px) {
            .buttons {
                flex-direction: column;
                gap: 10px;
            }

            .coupon {
                padding: 18px;
            }
        }

        /* Responsive para tablets */
        @media (min-width: 768px) {
            .container {
                gap: 25px;
            }

            .buttons {
                min-height: 100px;
            }
        }
    </style>
</head>
<body>
    <div class="progress-container">
        <div class="progress-bar" id="progressBar"></div>
    </div>
    
    <div class="hearts-bg" id="heartsBg"></div>
    <div class="sad-overlay" id="sadOverlay"></div>

    <div class="container" id="mainContainer">
        <div class="gif-container">
            <img id="mainGif" src="https://media.giphy.com/media/TRgyI2f0hRHBS/giphy.gif" alt="Triste">
        </div>
        
        <h1 id="question">¬øMe perdonas, Sofia? ü•∫‚ú®</h1>
        
        <div class="buttons" id="buttonsContainer">
            <button id="yesBtn">¬°S√≠, te perdono!</button>
            <button id="noBtn">No</button>
        </div>
    </div>

    <script>
        const yesBtn = document.getElementById('yesBtn');
        const noBtn = document.getElementById('noBtn');
        const question = document.getElementById('question');
        const mainGif = document.getElementById('mainGif');
        const buttonsContainer = document.getElementById('buttonsContainer');
        const progressBar = document.getElementById('progressBar');
        const sadOverlay = document.getElementById('sadOverlay');
        const heartsBg = document.getElementById('heartsBg');
        
        let clickCount = 0;
        const maxClicks = 6; // Despu√©s de 6 clicks desaparece el bot√≥n No
        let noBtnInitialized = false;
        
        // Crear elementos flotantes de fondo (variedad de emojis)
        const floatingEmojis = ['‚ú®', 'üíú', 'ü¶ã', 'üå∏', '‚≠ê', 'üåü', 'üíñ', 'üåº', 'üéÄ', 'üßö'];
        
        function createFloatingElements() {
            for (let i = 0; i < 10; i++) {
                setTimeout(() => {
                    const element = document.createElement('span');
                    element.className = 'floating-heart';
                    element.innerHTML = floatingEmojis[Math.floor(Math.random() * floatingEmojis.length)];
                    element.style.left = Math.random() * 100 + 'vw';
                    element.style.animationDelay = Math.random() * 5 + 's';
                    element.style.fontSize = (Math.random() * 16 + 14) + 'px';
                    heartsBg.appendChild(element);
                    
                    setTimeout(() => element.remove(), 6000);
                }, i * 400);
            }
        }
        createFloatingElements();
        setInterval(createFloatingElements, 5000);

        // Frases progresivas para la pregunta
        const questionTexts = [
            "¬øMe perdonas, Sofia? ü•∫‚ú®",
            "¬øSegura que no me perdonas? üò¢",
            "Por favor, Sofia... üôè",
            "¬°Voy a llorar si dices que no! üò≠",
            "Sofia, no me hagas esto... üòø",
            "¬øPor qu√© me haces esto? üò≠üò≠",
            "¬°SOFIA PORFAVOR! üò≠üôè"
        ];

        // Frases para el bot√≥n "No"
        const noTexts = ["¬øSegura?", "Pi√©nsalo...", "Ay no ü•∫", "üò¢", "ü•Ä", "..."];

        // Frases para el bot√≥n "S√≠"
        const yesTexts = [
            "¬°S√≠, te perdono!",
            "¬°S√ç, TE PERDONO! ‚ú®",
            "¬°¬°S√ç!! ¬°TE PERDONO! üåü",
            "¬°¬°¬°S√çIII!!! ‚≠ê‚≠ê",
            "‚ú® ¬°CLARO QUE S√ç! ‚ú®",
            "ü¶ã ¬°OBVIO! ü¶ã",
            "¬°HAAAAZ CLICK! ‚ú®"
        ];

        // GIFs que cambian seg√∫n la tristeza
        const sadGifs = [
            "https://media.giphy.com/media/TRgyI2f0hRHBS/giphy.gif",
            "https://media.giphy.com/media/3o6wrvdHFbwBrUFenu/giphy.gif",
            "https://media.giphy.com/media/d2lcHJTG5Tscg/giphy.gif",
            "https://media.giphy.com/media/L95W4wv8nnb9K/giphy.gif"
        ];

        // Mensajes dram√°ticos que aparecen
        const dramaticMessages = ["ü•Ä", "üò≠", "¬°NO!", "¬øPOR QU√â?", "PORFA", "üò¢üò¢", "‚ú®‚ú®‚ú®"];

        // Funci√≥n para mostrar mensaje dram√°tico
        function showDramaticMessage(text) {
            const msg = document.createElement('div');
            msg.className = 'dramatic-message';
            msg.textContent = text;
            document.body.appendChild(msg);
            setTimeout(() => msg.remove(), 1000);
        }

        // Funci√≥n para crear l√°grimas
        function createTears() {
            for (let i = 0; i < 4; i++) {
                setTimeout(() => {
                    const tear = document.createElement('span');
                    tear.className = 'tear';
                    tear.textContent = 'üíß';
                    tear.style.left = Math.random() * 100 + 'vw';
                    tear.style.top = '0';
                    document.body.appendChild(tear);
                    setTimeout(() => tear.remove(), 2000);
                }, i * 100);
            }
        }

        // Inicializar posici√≥n del bot√≥n No
        function initNoBtn() {
            if (clickCount >= maxClicks) return;
            
            const container = buttonsContainer.getBoundingClientRect();
            const btnWidth = noBtn.offsetWidth || 80;
            const btnHeight = noBtn.offsetHeight || 50;
            
            // Posicionar a la derecha del bot√≥n S√≠
            let initialX = Math.min(container.left + container.width / 2 + 70, window.innerWidth - btnWidth - 20);
            let initialY = Math.max(container.top + container.height / 2 - btnHeight / 2, 60);
            
            // Asegurar que est√© en pantalla
            initialX = Math.max(20, Math.min(initialX, window.innerWidth - btnWidth - 20));
            initialY = Math.max(60, Math.min(initialY, window.innerHeight - btnHeight - 20));
            
            noBtn.style.left = initialX + 'px';
            noBtn.style.top = initialY + 'px';
            noBtnInitialized = true;
        }
        
        window.addEventListener('load', () => {
            setTimeout(initNoBtn, 100);
        });
        window.addEventListener('resize', initNoBtn);

        // Funci√≥n para mover el bot√≥n No (huye del cursor)
        function moveNoButton(e) {
            if (clickCount < 3 || clickCount >= maxClicks) return; // Huye despu√©s de 3 clicks
            if (!noBtnInitialized) return;
            
            const btn = noBtn.getBoundingClientRect();
            const btnCenterX = btn.left + btn.width / 2;
            const btnCenterY = btn.top + btn.height / 2;
            
            let mouseX, mouseY;
            if (e.type.includes('touch')) {
                mouseX = e.touches[0].clientX;
                mouseY = e.touches[0].clientY;
            } else {
                mouseX = e.clientX;
                mouseY = e.clientY;
            }
            
            const distance = Math.hypot(mouseX - btnCenterX, mouseY - btnCenterY);
            
            // Solo huye si est√° cerca (100px)
            if (distance < 100) {
                const angle = Math.atan2(btnCenterY - mouseY, btnCenterX - mouseX);
                const moveDistance = 60 + Math.min(clickCount * 15, 100);
                
                let newX = btn.left + Math.cos(angle) * moveDistance;
                let newY = btn.top + Math.sin(angle) * moveDistance;
                
                // Mantener dentro de la pantalla con margen
                const margin = 25;
                newX = Math.max(margin, Math.min(window.innerWidth - btn.width - margin, newX));
                newY = Math.max(margin + 50, Math.min(window.innerHeight - btn.height - margin, newY));
                
                noBtn.style.left = newX + 'px';
                noBtn.style.top = newY + 'px';
            }
        }

        // Event listeners para que el bot√≥n huya
        document.addEventListener('mousemove', moveNoButton);
        document.addEventListener('touchmove', moveNoButton, { passive: true });

        // Click en bot√≥n No
        noBtn.addEventListener('click', (e) => {
            e.preventDefault();
            e.stopPropagation();
            
            clickCount++;
            
            // Actualizar barra de progreso
            progressBar.style.width = Math.min((clickCount / maxClicks) * 100, 100) + '%';
            
            // Crecimiento exponencial del bot√≥n S√≠
            const exponentialGrowth = Math.pow(1.4, clickCount);
            const baseSize = 100;
            const newSize = Math.min(baseSize * exponentialGrowth, window.innerWidth * 0.9);
            const newHeight = Math.min(45 + exponentialGrowth * 18, window.innerHeight * 0.6);
            const newFontSize = Math.min(1 + clickCount * 0.35, 3.5);
            
            yesBtn.style.width = newSize + 'px';
            yesBtn.style.height = newHeight + 'px';
            yesBtn.style.fontSize = newFontSize + 'rem';
            yesBtn.style.position = 'fixed';
            yesBtn.style.left = '50%';
            yesBtn.style.top = '50%';
            yesBtn.style.transform = 'translate(-50%, -50%)';
            yesBtn.textContent = yesTexts[Math.min(clickCount, yesTexts.length - 1)];
            
            // Encoger el bot√≥n No
            const shrinkFactor = Math.pow(0.75, clickCount);
            noBtn.style.transform = `scale(${shrinkFactor})`;
            noBtn.style.opacity = Math.max(1 - clickCount * 0.1, 0.15);
            noBtn.textContent = noTexts[Math.min(clickCount, noTexts.length - 1)];
            
            // Cambiar pregunta
            question.textContent = questionTexts[Math.min(clickCount, questionTexts.length - 1)];
            
            // Cambiar GIF cada 2 clicks
            if (clickCount % 2 === 0) {
                mainGif.src = sadGifs[Math.floor(Math.random() * sadGifs.length)];
            }
            
            // Oscurecer fondo gradualmente
            const darkness = Math.min(clickCount * 0.03, 0.25);
            sadOverlay.style.background = `rgba(0, 0, 0, ${darkness})`;
            
            // Efectos visuales
            showDramaticMessage(dramaticMessages[Math.floor(Math.random() * dramaticMessages.length)]);
            noBtn.classList.add('shake');
            setTimeout(() => noBtn.classList.remove('shake'), 400);
            
            // Crear l√°grimas
            if (clickCount >= 3) {
                createTears();
            }
            
            // Agregar GIF triste flotante
            const img = document.createElement('img');
            img.src = sadGifs[Math.floor(Math.random() * sadGifs.length)];
            img.classList.add('floating-gif');
            img.onerror = () => img.remove();
            
            // Posici√≥n en las esquinas
            const positions = [
                { x: 15, y: 70 },
                { x: window.innerWidth - 80, y: 70 },
                { x: 15, y: window.innerHeight - 90 },
                { x: window.innerWidth - 80, y: window.innerHeight - 90 }
            ];
            const pos = positions[Math.floor(Math.random() * positions.length)];
            img.style.left = pos.x + 'px';
            img.style.top = pos.y + 'px';
            document.body.appendChild(img);
            
            // Despu√©s de maxClicks (6), el bot√≥n No desaparece
            if (clickCount >= maxClicks) {
                noBtn.style.display = 'none';
                question.textContent = "¬°Solo queda una opci√≥n! üíú";
                showDramaticMessage("üíúüíúüíú");
            }
            
            // Vibraci√≥n del dispositivo
            if (navigator.vibrate) {
                navigator.vibrate(50);
            }
        });

        // Click en bot√≥n S√≠
        yesBtn.addEventListener('click', () => {
            // Vibraci√≥n de celebraci√≥n
            if (navigator.vibrate) {
                navigator.vibrate([100, 50, 100, 50, 200]);
            }
            
            document.body.innerHTML = `
                <div class="success-screen">
                    <h1 style="font-size: clamp(1.5rem, 7vw, 2.5rem); color: #7c4dff; margin-bottom: 15px; animation: fadeIn 0.5s ease;">
                        ¬°S√ç√ç√ç! ¬°SAB√çA QUE LO HAR√çAS! üéâ‚ú®
                    </h1>
                    <div style="margin-bottom: 15px;">
                        <img src="https://media.giphy.com/media/l0MYt5jPR6QX5pnqM/giphy.gif" alt="Celebraci√≥n" 
                             style="width: clamp(150px, 40vw, 250px); border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.25);">
                    </div>
                    <p style="font-size: clamp(1.1rem, 4.5vw, 1.6rem); color: #7c4dff; margin-bottom: 20px;">
                        Eres la mejor, Sofia ‚ú®üå∏
                    </p>
                    
                    <div style="max-width: 400px; width: 100%; padding: 0 15px;">
                        <p style="font-size: clamp(1rem, 4vw, 1.3rem); color: #7c4dff; margin-bottom: 15px; font-weight: bold;">üéÅ Tus Cupones üéÅ</p>
                        
                        <div id="couponsContainer" style="display: flex; flex-direction: column; gap: 15px; margin-bottom: 20px; align-items: center;">
                            <!-- Cup√≥n 1: Chocolate -->
                            <div id="coupon1" class="coupon clickable-coupon" onclick="saveCouponImage('coupon1', 'Cupon_Chocolate_Sofia')" style="background: linear-gradient(135deg, #8B4513, #D2691E);">
                                <div class="coupon-badge">V√ÅLIDO</div>
                                <p class="coupon-emoji">üç´</p>
                                <p class="coupon-title">Cup√≥n V√°lido</p>
                                <p class="coupon-subtitle" style="color: #FFE4B5;">Para un Chocolate</p>
                                <p class="coupon-save-hint">üì∏ Toca para guardar</p>
                            </div>
                            
                            <!-- Cup√≥n 2: Dulce -->
                            <div id="coupon2" class="coupon clickable-coupon" onclick="saveCouponImage('coupon2', 'Cupon_Dulce_Sofia')" style="background: linear-gradient(135deg, #FF69B4, #FFB6C1);">
                                <div class="coupon-badge">V√ÅLIDO</div>
                                <p class="coupon-emoji">üç¨</p>
                                <p class="coupon-title">Cup√≥n V√°lido</p>
                                <p class="coupon-subtitle" style="color: #FFF0F5;">Para Algo Dulce</p>
                                <p class="coupon-save-hint">üì∏ Toca para guardar</p>
                            </div>
                        </div>
                        
                        <a href="https://wa.me/529712631970?text=%C2%A1Hola%21%20%F0%9F%92%9C%20Acabo%20de%20perdonarte%20y%20vengo%20a%20reclamar%20mis%20cupones%3A%0A%0A%F0%9F%8D%AB%20Cup%C3%B3n%20de%20Chocolate%0A%F0%9F%8D%AC%20Cup%C3%B3n%20de%20Algo%20Dulce%0A%0A%C2%A1Los%20quiero%20ya%21%20%E2%9C%A8%F0%9F%8E%89" 
                           target="_blank" 
                           class="whatsapp-btn">
                            üì± Reclamar Cupones
                        </a>
                    </div>
                </div>
            `;
            
            // Agregar estilos para los cupones
            const style = document.createElement('style');
            style.textContent = `
                .coupon {
                    border-radius: 20px;
                    padding: clamp(20px, 5vw, 30px);
                    box-shadow: 0 10px 35px rgba(0, 0, 0, 0.3);
                    border: 4px dashed #FFD700;
                    position: relative;
                    overflow: hidden;
                    width: 100%;
                    max-width: 320px;
                }
                .coupon-badge {
                    position: absolute;
                    top: 10px;
                    right: 10px;
                    background: rgba(255, 215, 0, 0.3);
                    padding: 5px 12px;
                    border-radius: 20px;
                    font-size: 0.7rem;
                    color: #fff;
                    font-weight: bold;
                }
                .coupon-emoji {
                    font-size: clamp(2.5rem, 10vw, 4rem);
                    margin: 0 0 10px 0;
                    text-align: center;
                }
                .coupon-title {
                    font-size: clamp(1.1rem, 4.5vw, 1.5rem);
                    color: #fff;
                    margin: 0;
                    font-weight: bold;
                    text-align: center;
                    text-shadow: 2px 2px 4px rgba(0,0,0,0.4);
                    text-transform: uppercase;
                    letter-spacing: 1px;
                }
                .coupon-subtitle {
                    font-size: clamp(0.95rem, 4vw, 1.2rem);
                    margin: 8px 0 0 0;
                    text-align: center;
                    font-weight: 600;
                }
                .coupon-save-hint {
                    font-size: clamp(0.7rem, 2.8vw, 0.85rem);
                    margin: 12px 0 0 0;
                    text-align: center;
                    color: rgba(255, 255, 255, 0.85);
                    opacity: 0.9;
                    transition: all 0.3s ease;
                }
                .clickable-coupon {
                    cursor: pointer;
                    transition: transform 0.3s ease, box-shadow 0.3s ease;
                }
                .clickable-coupon:hover {
                    transform: scale(1.03);
                    box-shadow: 0 15px 45px rgba(0, 0, 0, 0.4);
                }
                .clickable-coupon:hover .coupon-save-hint {
                    opacity: 1;
                    transform: scale(1.05);
                }
                .clickable-coupon:active {
                    transform: scale(0.98);
                }
                .whatsapp-btn {
                    display: inline-block;
                    background: linear-gradient(145deg, #25D366, #128C7E);
                    color: white;
                    padding: clamp(14px, 3.5vw, 18px) clamp(30px, 7vw, 45px);
                    border-radius: 50px;
                    text-decoration: none;
                    font-weight: bold;
                    font-size: clamp(0.95rem, 3.5vw, 1.15rem);
                    box-shadow: 0 8px 25px rgba(37, 211, 102, 0.5);
                    transition: all 0.3s ease;
                    border: 2px solid #fff;
                }
                .whatsapp-btn:hover, .whatsapp-btn:active {
                    transform: scale(1.05);
                    box-shadow: 0 10px 30px rgba(37, 211, 102, 0.7);
                }
            `;
            document.head.appendChild(style);
            
            // Mega confeti de celebraci√≥n
            createConfetti();
            
            // M√°s elementos flotando en celebraci√≥n
            const celebrationEmojis = ['‚ú®', '‚≠ê', 'üåü', 'üéâ', 'ü¶ã', 'üå∏'];
            setInterval(() => {
                for (let i = 0; i < 4; i++) {
                    const element = document.createElement('span');
                    element.style.cssText = `
                        position: fixed;
                        font-size: ${Math.random() * 25 + 18}px;
                        left: ${Math.random() * 100}vw;
                        bottom: -50px;
                        animation: floatUp 4s ease-out forwards;
                        z-index: 1000;
                    `;
                    element.textContent = celebrationEmojis[Math.floor(Math.random() * celebrationEmojis.length)];
                    document.body.appendChild(element);
                    setTimeout(() => element.remove(), 4000);
                }
            }, 600);
        });

        function createConfetti() {
            const colors = ['#7c4dff', '#b388ff', '#e8d5f2', '#ff69b4', '#ffd700', '#00ff88', '#ff6b6b'];
            const shapes = ['‚ú®', '‚≠ê', 'üéâ', 'üí´', 'üåü', 'ü¶ã', 'üå∏'];
            
            for (let i = 0; i < 150; i++) {
                setTimeout(() => {
                    const isEmoji = Math.random() > 0.6;
                    const confetti = document.createElement('div');
                    confetti.style.cssText = `
                        position: fixed;
                        top: -20px;
                        left: ${Math.random() * 100}vw;
                        font-size: ${isEmoji ? Math.random() * 18 + 12 : 0}px;
                        width: ${isEmoji ? 'auto' : (Math.random() * 10 + 5) + 'px'};
                        height: ${isEmoji ? 'auto' : (Math.random() * 10 + 5) + 'px'};
                        background: ${isEmoji ? 'transparent' : colors[Math.floor(Math.random() * colors.length)]};
                        border-radius: ${Math.random() > 0.5 ? '50%' : '0'};
                        animation: fall ${Math.random() * 3 + 2}s linear forwards;
                        z-index: 1000;
                    `;
                    confetti.textContent = isEmoji ? shapes[Math.floor(Math.random() * shapes.length)] : '';
                    document.body.appendChild(confetti);
                    setTimeout(() => confetti.remove(), 5000);
                }, i * 25);
            }
        }

        // Funci√≥n para guardar cup√≥n como imagen usando html2canvas
        window.saveCouponImage = async function(couponId, filename) {
            const coupon = document.getElementById(couponId);
            if (!coupon) {
                alert('‚ùå No se encontr√≥ el cup√≥n');
                return;
            }
            
            // Encontrar el hint y ocultarlo temporalmente
            const hint = coupon.querySelector('.coupon-save-hint');
            if (hint) {
                hint.style.display = 'none';
            }
            
            // Cambiar el hint a "Guardando..." temporalmente
            const originalHintText = hint ? hint.textContent : '';
            
            try {
                // Usar html2canvas para capturar el cup√≥n
                const canvas = await html2canvas(coupon, {
                    scale: 2, // Mayor calidad
                    backgroundColor: null,
                    useCORS: true,
                    logging: false,
                    allowTaint: true
                });
                
                // Convertir a imagen y descargar
                const link = document.createElement('a');
                link.download = filename + '.png';
                link.href = canvas.toDataURL('image/png');
                link.click();
                
                // Mostrar confirmaci√≥n en el hint
                if (hint) {
                    hint.style.display = 'block';
                    hint.textContent = '‚úÖ ¬°Guardado!';
                    hint.style.color = '#90EE90';
                    setTimeout(() => {
                        hint.textContent = originalHintText;
                        hint.style.color = '';
                    }, 2000);
                }
                
            } catch (error) {
                console.error('Error al guardar:', error);
                
                // Restaurar hint
                if (hint) {
                    hint.style.display = 'block';
                }
                
                // Fallback: abrir en nueva ventana para screenshot manual
                alert('üí° Tip: Haz una captura de pantalla (screenshot) del cup√≥n para guardarlo üì∏');
            }
        };
    </script>
</body>
</html>
